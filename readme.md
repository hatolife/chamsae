# Chamsae - Hangul IME (ãƒãƒ³ã‚°ãƒ«IME)

ãƒ­ãƒ¼ãƒå­—å…¥åŠ›ã‹ã‚‰éŸ“å›½èªãƒãƒ³ã‚°ãƒ«æ–‡å­—ã¸ã®å¤‰æ›ã‚’è¡Œã†IME (Input Method Editor)ã€‚

Rustå­¦ç¿’ã‚’å…¼ã­ãŸè‡ªä½œIMEãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€‚

## ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

| é …ç›® | çŠ¶æ…‹ |
|------|------|
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | v0.2.0 (é–‹ç™ºä¸­) |
| ãƒ•ã‚§ãƒ¼ã‚º | Phase 2 å®Œäº† |
| ãƒ†ã‚¹ãƒˆ | 47ãƒ†ã‚¹ãƒˆé€šé |
| å¯¾å¿œOS | CLI: Windows/Linux, DLL: Windows |

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# ãƒ“ãƒ«ãƒ‰
cargo build --release

# å˜ä¸€å¤‰æ›
./target/release/chamsae -i "an nyeong ha se yo"
# å‡ºåŠ›: ì•ˆë…•í•˜ì„¸ìš”

# ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰
./target/release/chamsae -I
> han gug eo
  â†’ í•œêµ­ì–´
> exit
```

## å…¥åŠ›è¦å‰‡

| å…¥åŠ› | æ„å‘³ | ä¾‹ |
|------|------|-----|
| åŠè§’ã‚¹ãƒšãƒ¼ã‚¹1ã¤ | éŸ³ç¯€åŒºåˆ‡ã‚Š | `han gug` â†’ í•œêµ­ |
| åŠè§’ã‚¹ãƒšãƒ¼ã‚¹2ã¤ | å®Ÿéš›ã®ã‚¹ãƒšãƒ¼ã‚¹ | `an nyeong  ha se yo` â†’ ì•ˆë…• í•˜ì„¸ìš” |

è©³ç´°ã¯ [spec_v0.1.0.md](./spec_v0.1.0.md) / [spec_v0.2.0.md](./spec_v0.2.0.md) ã‚’å‚ç…§ã€‚

---

## ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1: å¤‰æ›ã‚¨ãƒ³ã‚¸ãƒ³ âœ… å®Œäº†

| å†…å®¹ | çŠ¶æ…‹ |
|------|------|
| Rustç’°å¢ƒæ§‹ç¯‰ãƒ»åŸºç¤å­¦ç¿’ | âœ… |
| CLIãƒ„ãƒ¼ãƒ« (clap, anyhow) | âœ… |
| ãƒãƒ³ã‚°ãƒ«å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ | âœ… |

### Phase 2: Windows APIå…¥é–€ âœ… å®Œäº†

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | å†…å®¹ | çŠ¶æ…‹ |
|---------------|------|------|
| 2.1 | windows-rs ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | âœ… |
| 2.2 | Win32 åŸºæœ¬ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½œæˆ | âœ… |
| 2.3 | COMåŸºç¤ (IUnknown, ClassFactory) | âœ… |
| 2.4 | DLLä½œæˆãƒ»ãƒ¬ã‚¸ã‚¹ãƒˆãƒªç™»éŒ² | âœ… |

### Phase 3: TSF IMEå®Ÿè£… ğŸ”œ æ¬¡

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | å†…å®¹ | äºˆå®š |
|---------------|------|------|
| 3.1 | TSFæœ€å°ã‚¹ã‚±ãƒ«ãƒˆãƒ³ | Week 3 |
| 3.2 | ITfTextInputProcessorExå®Ÿè£… | Week 3-4 |
| 3.3 | ã‚­ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç† | Week 4 |
| 3.4 | å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯çµ±åˆ | Week 5 |
| 3.5 | å€™è£œã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (åŸºæœ¬) | Week 5-6 |

**ç›®æ¨™**: ã‚·ã‚¹ãƒ†ãƒ IMEã¨ã—ã¦å‹•ä½œã™ã‚‹æœ€å°å®Ÿè£…

### Phase 4: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰æ›

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | å†…å®¹ | äºˆå®š |
|---------------|------|------|
| 4.1 | ã‚­ãƒ¼å…¥åŠ›å˜ä½ã®å‡¦ç† | Week 7 |
| 4.2 | çµ‚å£°ã®è‡ªå‹•ç§»å‹• (é€£éŸ³åŒ–) | Week 7 |
| 4.3 | Compositionæ–‡å­—åˆ—è¡¨ç¤º | Week 8 |
| 4.4 | ãƒãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¹å‡¦ç† | Week 8 |

**ç›®æ¨™**: éŸ“å›½IMEã¨åŒæ§˜ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å†æ§‹æˆ

### Phase 5: æ”¹å–„ãƒ»æ‹¡å¼µ

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | å†…å®¹ | å„ªå…ˆåº¦ |
|---------------|------|--------|
| 5.1 | è¨­å®šç”»é¢ | ä¸­ |
| 5.2 | ãƒˆãƒ¬ã‚¤ã‚¢ã‚¤ã‚³ãƒ³ | ä¸­ |
| 5.3 | ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ä½œæˆ | é«˜ |
| 5.4 | å¤‰æ›å€™è£œè¡¨ç¤º | ä½ |
| 5.5 | ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ | ä½ |

---

## ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å†…å®¹ |
|-----------|------|------|
| v0.2.0 | 2026-01-29 | Windows DLLæ§‹é€ , COMåŸºç¤, Win32ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ |
| v0.0.1 | 2025-01-30 | å¤‰æ›ã‚¨ãƒ³ã‚¸ãƒ³å®Œæˆã€CLIãƒ„ãƒ¼ãƒ« |

### äºˆå®šãƒãƒ¼ã‚¸ãƒ§ãƒ³

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç›®æ¨™ | ä¸»ãªæ©Ÿèƒ½ |
|-----------|------|----------|
| v0.3.0 | Phase 3å®Œäº† | TSF IMEå‹•ä½œ |
| v0.4.0 | Phase 4å®Œäº† | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰æ› |
| v1.0.0 | Phase 5å®Œäº† | å®Ÿç”¨ãƒ¬ãƒ™ãƒ« |

---

## é–‹ç™ºç’°å¢ƒ

### å¿…è¦ãªã‚‚ã®

| é …ç›® | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|------|-----------|
| Rust | 1.75+ |
| Windows SDK | 10.0+ (Phase 2ä»¥é™) |
| Visual Studio Build Tools | 2022 (Phase 2ä»¥é™) |

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Rustã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Windowsã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« (Linuxä¸Šã§é–‹ç™ºã™ã‚‹å ´åˆ)
rustup target add x86_64-pc-windows-gnu

# ãƒ“ãƒ«ãƒ‰
cargo build

# ãƒ†ã‚¹ãƒˆ
cargo test

# ãƒªãƒ³ã‚¿ãƒ¼
cargo clippy
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
chamsae/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ makefile
â”œâ”€â”€ readme.md           # æœ¬ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ spec_v0.1.0.md      # ä»•æ§˜æ›¸ (Phase 1)
â”œâ”€â”€ spec_v0.2.0.md      # ä»•æ§˜æ›¸ (Phase 2)
â””â”€â”€ src/
    â”œâ”€â”€ lib.rs          # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ«ãƒ¼ãƒˆ + DLLã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    â”œâ”€â”€ hangul.rs       # å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ + ãƒ†ã‚¹ãƒˆ
    â”œâ”€â”€ guid.rs         # GUID/CLSIDå®šç¾©
    â”œâ”€â”€ registry.rs     # ãƒ¬ã‚¸ã‚¹ãƒˆãƒªç™»éŒ²
    â”œâ”€â”€ com/
    â”‚   â”œâ”€â”€ mod.rs      # COMãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â”‚   â”œâ”€â”€ class_factory.rs  # IClassFactoryå®Ÿè£…
    â”‚   â””â”€â”€ dll_module.rs     # DLLãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†
    â”œâ”€â”€ win32/
    â”‚   â”œâ”€â”€ mod.rs      # Win32ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â”‚   â””â”€â”€ window.rs   # åŸºæœ¬ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½œæˆ
    â””â”€â”€ bin/
        â”œâ”€â”€ cli.rs      # CLIãƒ„ãƒ¼ãƒ«
        â””â”€â”€ window_test.rs  # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ†ã‚¹ãƒˆ
```

### å°†æ¥ã®æ§‹æˆ (Phase 3ä»¥é™)

```
chamsae/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ readme.md
â”œâ”€â”€ spec_v*.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs          # DLLã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ hangul.rs       # å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ guid.rs         # GUIDå®šç¾©
â”‚   â”œâ”€â”€ registry.rs     # ãƒ¬ã‚¸ã‚¹ãƒˆãƒªç™»éŒ²
â”‚   â”œâ”€â”€ com/            # COMåŸºç›¤
â”‚   â”œâ”€â”€ win32/          # Win32ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ tsf/
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ text_service.rs
â”‚   â”‚   â”œâ”€â”€ key_handler.rs
â”‚   â”‚   â””â”€â”€ composition.rs
â”‚   â””â”€â”€ bin/
â”‚       â”œâ”€â”€ cli.rs      # CLIãƒ„ãƒ¼ãƒ« (é–‹ç™ºç”¨)
â”‚       â””â”€â”€ window_test.rs
â””â”€â”€ installer/
    â””â”€â”€ setup.iss       # Inno Setup ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ç”¨é€” | ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
|------|-----------|
| å¼•æ•°è§£æ | clap |
| ã‚¨ãƒ©ãƒ¼å‡¦ç† | anyhow |
| Windows API | windows-rs 0.58 |
| ãƒ†ã‚¹ãƒˆ | æ¨™æº– (cargo test) |

---

## DLLç™»éŒ² (Windows)

Phase 2ã§ä½œæˆã—ãŸDLLã‚’Windowsã«ç™»éŒ²ã™ã‚‹æ‰‹é †ã€‚

> **æ³¨æ„**: ç¾åœ¨ (v0.2.0) ã®DLLã¯COMåŸºç›¤ã®ã¿ã®å®Ÿè£…ã§ã™ã€‚
> ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¸ã®CLSIDç™»éŒ²ã¯å¯èƒ½ã§ã™ãŒã€IMEã¨ã—ã¦ã¯ã¾ã å‹•ä½œã—ã¾ã›ã‚“ã€‚
> IMEã¨ã—ã¦ä½¿ç”¨å¯èƒ½ã«ãªã‚‹ã®ã¯Phase 3 (TSFå®Ÿè£…) ä»¥é™ã§ã™ã€‚

### ãƒ“ãƒ«ãƒ‰

```bat
cargo build --release --target x86_64-pc-windows-gnu
```

### ç™»éŒ²ãƒ»è§£é™¤

**ç®¡ç†è€…æ¨©é™ã®ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```bat
REM DLLã®ç™»éŒ²
regsvr32 target\x86_64-pc-windows-gnu\release\chamsae.dll

REM DLLã®ç™»éŒ²è§£é™¤
regsvr32 /u target\x86_64-pc-windows-gnu\release\chamsae.dll
```

### ç™»éŒ²ã®ç¢ºèª

ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¨ãƒ‡ã‚£ã‚¿ (`regedit`) ã§ä»¥ä¸‹ã®ã‚­ãƒ¼ãŒä½œæˆã•ã‚Œã¦ã„ã‚Œã°æˆåŠŸã§ã™ã€‚
ã“ã®GUIDã¯ `src/guid.rs` ã§å›ºå®šå®šç¾©ã•ã‚ŒãŸå€¤ã§ã€ãƒ“ãƒ«ãƒ‰ã”ã¨ã«å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚

```
HKEY_CLASSES_ROOT\CLSID\{D4A5B8E1-7C2F-4A3D-9E6B-1F8C0D2A5E7B}
â”œâ”€â”€ (Default) = "Chamsae Hangul IME"
â””â”€â”€ InprocServer32
    â”œâ”€â”€ (Default) = "<DLLã®çµ¶å¯¾ãƒ‘ã‚¹>"
    â””â”€â”€ ThreadingModel = "Apartment"
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| ç—‡çŠ¶ | åŸå› ãƒ»å¯¾å‡¦ |
|------|-----------|
| `regsvr32` ã§ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ | ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã—ã¦ã„ãªã„ã€‚ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã€Œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã€ã§é–‹ã |
| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ | DLLãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹ã€‚çµ¶å¯¾ãƒ‘ã‚¹ã§æŒ‡å®šã™ã‚‹ã‹ã€DLLã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œã™ã‚‹ |
| ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„ | ãƒ“ãƒ«ãƒ‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæ­£ã—ããªã„ã€‚`--target x86_64-pc-windows-gnu` ã‚’ç¢ºèªã™ã‚‹ |

---

## å‚è€ƒè³‡æ–™

### ãƒãƒ³ã‚°ãƒ«

- [Unicode Hangul Syllables](https://en.wikipedia.org/wiki/Korean_language_and_computers#Hangul_in_Unicode)
- [Revised Romanization of Korean](https://en.wikipedia.org/wiki/Revised_Romanization_of_Korean)

### Windows TSF

- [Text Services Framework (Microsoft Docs)](https://docs.microsoft.com/en-us/windows/win32/tsf/text-services-framework)
- [Windows Classic Samples - IME](https://github.com/microsoft/Windows-classic-samples/tree/main/Samples/IME)
- [windows-rs](https://github.com/microsoft/windows-rs)

### Rust IMEå®Ÿè£…ä¾‹

- [rust-ime](https://github.com/pxsta/rust-ime) - Rust TSF IMEã®å‚è€ƒå®Ÿè£…

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

CC0 1.0 Universal

---

## ä½œè€…ãƒ¡ãƒ¢

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯Rustå­¦ç¿’ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚
å®Ÿç”¨IMEã¨ã—ã¦ã®å®Œæˆåº¦ã‚ˆã‚Šã€å­¦ç¿’éç¨‹ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚
